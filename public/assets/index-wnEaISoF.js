import{d as P,i as O,j as V,r as i,k as I,o as g,c as C,w as t,f as l,h as p,$ as v,g as r,t as b,b as L,l as M,F as $,Z as q,bE as G,br as j,bF as A,B as K,m as Z}from"./index-DItnb3D9.js";import{_ as H}from"./movie-card.vue_vue_type_script_setup_true_lang-BbBdxZNE.js";import{s as J,p as Q}from"./library-D4JW-QQB.js";import{f as W}from"./category-DX66RkgZ.js";import{f as X}from"./movie-BrVTha2p.js";import{a as Y,_ as ee}from"./FormItem-Dtq-PGbP.js";import{_ as ae}from"./Space-D7PNJy4T.js";import{_ as le}from"./text-Caewz_j-.js";import{_ as te}from"./Pagination-DtpHMPZw.js";import{_ as oe}from"./Flex-Cs8l2fCs.js";import"./p-B4gxHpB1.js";import"./Rate-B08BRAue.js";import"./get-slot-Bk_rJcZu.js";import"./prop-BjyUHhTu.js";const Se=P({name:"library",__name:"index",setup(ne){const y=O(),z=V(),h=[{label:"年份",value:"year"},{label:"番号",value:"num"},{label:"综合评分",value:"score"},{label:"个人评分",value:"personalScore"},{label:"添加时间",value:"createdTime"},{label:"上映时间",value:"releaseTime"},{label:"播放次数",value:"viewCount"}],c=i(1),_=i(0),a=i({viewCount:0,sort:"createdTime",sortRule:"DESC",pageSize:20,folder:null,page:1}),m=i([]);async function n(){const u=z.query.folder;u?a.value.folder=u:a.value.folder=null,y.setCacheSearchData(a.value),X(a.value).then(e=>{e.data!==null?(m.value=e.data.records,c.value=Math.ceil(e.data.total/a.value.pageSize),_.value=e.data.total):(m.value=[],c.value=1,_.value=0)})}function N(){a.value={years:null,keyword:"",type:null,tags:null,viewCount:0,favorite:null,folder:null,sort:"createdTime",sortRule:"DESC",pageSize:20,page:1},n()}const S=i([]);function x(){W({page:1,pageSize:999,type:"tag",sort:"value",sortRule:"DESC"}).then(u=>{u.data&&u.data.records.forEach(e=>{S.value.push({label:e.key,value:e.value})})})}return I(()=>{const u=y.getCacheSearchData();u&&(a.value=u.data),x(),n()}),(u,e)=>{const U=q,D=G,s=Y,d=j,k=A,w=K,f=ae,T=le,R=ee,B=Z,E=te,F=oe;return g(),C(F,{vertical:""},{default:t(()=>[l(B,{bordered:!1,class:"relative z-4 rd-12px"},{default:t(()=>[l(R,{"label-placement":"left","label-width":85,"require-mark-placement":"right-hanging",size:"small"},{default:t(()=>[l(f,{"item-style":"display: flex;",align:"center"},{default:t(()=>[l(s,{label:p(v)("page.library.searchKey")},{default:t(()=>[l(D,null,{default:t(()=>[l(U,{value:a.value.keyword,"onUpdate:value":e[0]||(e[0]=o=>a.value.keyword=o),type:"text",placeholder:"请输入标题关键词",class:"max-w-xl"},null,8,["value"])]),_:1})]),_:1},8,["label"]),l(s,null,{default:t(()=>[l(d,{value:a.value.tags,"onUpdate:value":[e[1]||(e[1]=o=>a.value.tags=o),n],options:S.value,placeholder:p(v)("page.library.tags"),filterable:"",clearable:"",class:"w-40"},null,8,["value","options","placeholder"])]),_:1}),l(s,null,{default:t(()=>[l(d,{value:a.value.years,"onUpdate:value":[e[2]||(e[2]=o=>a.value.years=o),n],placeholder:p(v)("page.library.yearGroup"),class:"w-35",clearable:"",multiple:"","max-tag-count":"responsive",options:[{label:"2025",value:"2025"},{label:"2024",value:"2024"},{label:"2023",value:"2023"},{label:"2022",value:"2022"},{label:"2021",value:"2021"},{label:"2020",value:"2020"},{label:"2019 - 2015",value:"2019-2015"},{label:"2014 - 2010",value:"2015-2010"},{label:"2009 - 2000",value:"2009-2000"},{label:"90年代",value:"1999-1990"},{label:"80年代",value:"1989-1980"},{label:"更早",value:"1979-1900"}]},null,8,["value","placeholder"])]),_:1}),l(s,null,{default:t(()=>[l(d,{value:a.value.sort,"onUpdate:value":[e[3]||(e[3]=o=>a.value.sort=o),n],options:h,class:"w-40"},null,8,["value"])]),_:1}),l(s,null,{default:t(()=>[l(d,{value:a.value.sortRule,"onUpdate:value":[e[4]||(e[4]=o=>a.value.sortRule=o),n],options:p(J),class:"w-40"},null,8,["value","options"])]),_:1}),l(s,null,{default:t(()=>[l(k,{value:a.value.viewCount,"onUpdate:value":e[5]||(e[5]=o=>a.value.viewCount=o),"checked-value":0,"unchecked-value":-1,onUpdateValue:n},{checked:t(()=>e[9]||(e[9]=[r("未播放")])),unchecked:t(()=>e[10]||(e[10]=[r("全部")])),_:1},8,["value"])]),_:1}),l(s,null,{default:t(()=>[l(k,{value:a.value.favorite,"onUpdate:value":e[6]||(e[6]=o=>a.value.favorite=o),"checked-value":!0,"unchecked-value":void 0,onUpdateValue:n},{checked:t(()=>e[11]||(e[11]=[r("已收藏")])),unchecked:t(()=>e[12]||(e[12]=[r("全部")])),_:1},8,["value"])]),_:1}),l(s,null,{default:t(()=>[l(w,{type:"primary",onClick:n},{default:t(()=>[r(b(p(v)("common.search")),1)]),_:1})]),_:1}),l(s,null,{default:t(()=>[l(w,{type:"default",ghost:"",onClick:N},{default:t(()=>[r(b(p(v)("common.reset")),1)]),_:1})]),_:1})]),_:1}),l(T,{class:"ml-8"},{default:t(()=>[r(b("共找到 "+_.value+" 部影片"),1)]),_:1})]),_:1})]),_:1}),l(f,null,{default:t(()=>[(g(!0),L($,null,M(m.value,o=>(g(),C(H,{key:o.id,movie:o,sort:a.value.sort},null,8,["movie","sort"]))),128))]),_:1}),l(f,null,{default:t(()=>[l(E,{page:a.value.page,"onUpdate:page":e[7]||(e[7]=o=>a.value.page=o),"page-size":a.value.pageSize,"onUpdate:pageSize":e[8]||(e[8]=o=>a.value.pageSize=o),"page-count":c.value,"show-size-picker":"","page-sizes":p(Q),onUpdatePage:n,onUpdatePageSize:n},null,8,["page","page-size","page-count","page-sizes"])]),_:1})]),_:1})}}});export{Se as default};
