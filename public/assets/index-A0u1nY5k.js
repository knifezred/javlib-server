import{d as V,i as j,r as c,k as q,o as m,c as C,w as a,f as e,h as s,$ as r,aa as A,ab as K,b as x,l as N,F as z,g as _,t as v,aP as H,aO as J,au as Q,bG as W,br as X,bS as Y,B as Z,m as ee}from"./index-CkCE23X5.js";import{s as ae,p as le}from"./library-Cj7CXVcl.js";import{_ as te}from"./movie-card.vue_vue_type_script_setup_true_lang-DwJfhy4G.js";import{f as ne,i as oe}from"./movie-CZDh539z.js";import{f as ue}from"./category-BSBI3fAB.js";import{_ as se}from"./Space-y8ctviet.js";import{_ as pe,a as re}from"./FormItem-BkFXHVYn.js";import{_ as ie}from"./text-BzG7xH7h.js";import{_ as _e,a as de}from"./CollapseItem-CpKQmY58.js";import{_ as ce}from"./Pagination-DUiDsJnU.js";import{_ as me}from"./Flex-BEO7kmsB.js";import"./p-Cdf8pl75.js";const Ue=V({name:"library",__name:"index",setup(ve){const h=j(),U=[{label:"年份",value:"year"},{label:"番号",value:"num"},{label:"综合评分",value:"score"},{label:"个人评分",value:"personalScore"},{label:"添加时间",value:"createdTime"},{label:"上映时间",value:"releaseTime"},{label:"播放次数",value:"viewCount"}],g=c(1),f=c(0),l=c({viewCount:0,sort:"createdTime",sortRule:"DESC",pageSize:30,page:1}),b=c([]);async function i(){h.setCacheSearchData(l.value),ne(l.value).then(u=>{u.data!==null?(b.value=u.data.records,g.value=Math.ceil(u.data.total/l.value.pageSize),f.value=u.data.total):(b.value=[],g.value=1,f.value=0)})}function D(){l.value={years:null,keyword:"",type:null,tags:null,viewCount:0,sort:"createdTime",sortRule:"DESC",pageSize:20,page:1},i()}function T(){var u;(u=window.$message)==null||u.info("后台添加中，请耐心等待"),oe()}const y=c([]);function B(){ue({page:1,pageSize:5,type:"tag",sort:"value",sortRule:"DESC"}).then(u=>{u.data&&(y.value=u.data.records)})}return q(()=>{const u=h.getCacheSearchData();u&&(l.value=u.data),B(),i()}),(u,n)=>{const o=H,d=se,S=J,p=pe,L=Q,P=W,k=X,R=Y,w=Z,F=ie,O=re,E=_e,G=de,I=ee,M=ce,$=me;return m(),C($,{vertical:""},{default:a(()=>[e(I,{bordered:!1,class:"relative z-4 w-auto rd-12px"},{default:a(()=>[e(G,{"default-expanded-names":[]},{default:a(()=>[e(E,{title:s(r)("common.search"),name:"1"},{default:a(()=>[e(O,{"label-placement":"left","label-width":54,"require-mark-placement":"right-hanging",size:"small"},{default:a(()=>[e(p,{label:s(r)("page.library.type"),class:"hidden h-10"},{default:a(()=>[e(S,{value:l.value.type,"onUpdate:value":n[0]||(n[0]=t=>l.value.type=t)},{default:a(()=>[e(d,{"item-style":"display: flex;",align:"center"},{default:a(()=>[e(o,{value:"内地",label:"内地"}),e(o,{value:"港台",label:"港台"}),e(o,{value:"日本",label:"日本"})]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),A(e(p,{label:s(r)("page.library.tags"),class:"hidden h-10"},{default:a(()=>[e(S,{value:l.value.tags,"onUpdate:value":n[1]||(n[1]=t=>l.value.tags=t)},{default:a(()=>[e(d,{"item-style":"display: flex;",align:"center"},{default:a(()=>[(m(!0),x(z,null,N(y.value,t=>(m(),C(o,{key:t.id,value:t.key,label:t.key},null,8,["value","label"]))),128))]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),[[K,y.value.length>0]]),e(p,{label:s(r)("page.library.yearGroup"),class:"hidden h-10"},{default:a(()=>[e(S,{value:l.value.years,"onUpdate:value":n[2]||(n[2]=t=>l.value.years=t)},{default:a(()=>[e(d,{"item-style":"display: flex;",align:"center"},{default:a(()=>[e(o,{value:"2024",label:"2024"}),e(o,{value:"2023",label:"2023"}),e(o,{value:"2022",label:"2022"}),e(o,{value:"2021",label:"2021"}),e(o,{value:"2020",label:"2020"}),e(o,{value:"2019-2015",label:"2019 - 2015"}),e(o,{value:"2015-2010",label:"2014 - 2010"}),e(o,{value:"2009-2000",label:"2009 - 2000"}),e(o,{value:"1999-1990",label:"90年代"}),e(o,{value:"1989-1980",label:"80年代"}),e(o,{value:"1979-1900",label:"更早"})]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),e(p,{label:s(r)("page.library.searchKey")},{default:a(()=>[e(P,null,{default:a(()=>[e(L,{value:l.value.keyword,"onUpdate:value":n[3]||(n[3]=t=>l.value.keyword=t),type:"text",placeholder:"请输入标题关键词",class:"max-w-xl"},null,8,["value"])]),_:1})]),_:1},8,["label"]),e(d,{"item-style":"display: flex;",align:"center"},{default:a(()=>[e(p,{label:s(r)("common.sort")},{default:a(()=>[e(k,{value:l.value.sort,"onUpdate:value":[n[4]||(n[4]=t=>l.value.sort=t),i],options:U,class:"w-26"},null,8,["value"])]),_:1},8,["label"]),e(p,null,{default:a(()=>[e(k,{value:l.value.sortRule,"onUpdate:value":[n[5]||(n[5]=t=>l.value.sortRule=t),i],options:s(ae),class:"w-24"},null,8,["value","options"])]),_:1}),e(p,null,{default:a(()=>[e(R,{value:l.value.viewCount,"onUpdate:value":n[6]||(n[6]=t=>l.value.viewCount=t),"checked-value":0,"unchecked-value":-1,onUpdateValue:i},{checked:a(()=>n[9]||(n[9]=[_("未播放")])),unchecked:a(()=>n[10]||(n[10]=[_("全部")])),_:1},8,["value"])]),_:1}),e(p,null,{default:a(()=>[e(w,{type:"primary",onClick:i},{default:a(()=>[_(v(s(r)("common.search")),1)]),_:1})]),_:1}),e(p,null,{default:a(()=>[e(w,{type:"default",ghost:"",onClick:D},{default:a(()=>[_(v(s(r)("common.reset")),1)]),_:1})]),_:1})]),_:1}),e(p,null,{default:a(()=>[e(F,null,{default:a(()=>[_(v("共找到 "+f.value+" 部影片"),1)]),_:1}),e(w,{type:"warning",class:"ml-2",onClick:T},{default:a(()=>[_(v(s(r)("page.library.updateLibrary")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["title"])]),_:1})]),_:1}),e(d,{justify:"center"},{default:a(()=>[(m(!0),x(z,null,N(b.value,t=>(m(),C(te,{key:t.id,movie:t,"show-second-title":!0,sort:l.value.sort},null,8,["movie","sort"]))),128))]),_:1}),e(M,{page:l.value.page,"onUpdate:page":n[7]||(n[7]=t=>l.value.page=t),"page-size":l.value.pageSize,"onUpdate:pageSize":n[8]||(n[8]=t=>l.value.pageSize=t),"page-count":g.value,"show-size-picker":"",simple:"",class:"ma-auto","page-sizes":s(le),onUpdatePage:i,onUpdatePageSize:i},null,8,["page","page-size","page-count","page-sizes"])]),_:1})}}});export{Ue as default};
