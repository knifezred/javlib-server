import{d as P,i as $,n as O,r as i,j as V,o as g,c as C,w as t,f as a,h as p,$ as v,g as r,t as b,b as I,k as L,F as M,l as q,bD as G,bo as j,bE as A,B as K,s as H}from"./index-G0XXQiiJ.js";import{_ as J}from"./movie-card.vue_vue_type_script_setup_true_lang-CX2NC1kF.js";import{s as Q,p as W}from"./library-D4JW-QQB.js";import{f as X}from"./category-DlmCSPJ1.js";import{f as Y}from"./movie-DpZnKH93.js";import{_ as Z,a as ee}from"./FormItem-CBeD6pwd.js";import{_ as le}from"./Space-DdY25akT.js";import{_ as ae}from"./text-oUQLZaH4.js";import{_ as te}from"./Pagination-7NdVwkNR.js";import{_ as oe}from"./Flex-Dlopc3Zl.js";import"./headers-CFrI0wwt.js";import"./p-CrdgHcto.js";import"./get-slot-Bk_rJcZu.js";import"./prop-BjyUHhTu.js";const Se=P({name:"library",__name:"index",setup(ne){const y=$(),z=O(),h=[{label:"年份",value:"year"},{label:"番号",value:"num"},{label:"综合评分",value:"score"},{label:"个人评分",value:"personalScore"},{label:"添加时间",value:"createdTime"},{label:"上映时间",value:"releaseTime"},{label:"播放次数",value:"viewCount"}],c=i(1),_=i(0),l=i({viewCount:-1,sort:"createdTime",sortRule:"DESC",pageSize:20,folder:null,page:1}),m=i([]);async function n(){const u=z.query.folder;u?l.value.folder=u:l.value.folder=null,y.setCacheSearchData(l.value),Y(l.value).then(e=>{e.data!==null?(m.value=e.data.records,c.value=Math.ceil(e.data.total/l.value.pageSize),_.value=e.data.total):(m.value=[],c.value=1,_.value=0)})}function x(){l.value={years:null,keyword:"",type:null,tags:null,tag:null,viewCount:-1,favorite:null,folder:null,sort:"createdTime",sortRule:"DESC",pageSize:20,page:1},n()}const S=i([]);function N(){X({page:1,pageSize:999,type:"tag",sort:"value",sortRule:"DESC"}).then(u=>{u.data&&u.data.records.forEach(e=>{S.value.push({label:e.key,value:e.key})})})}return V(()=>{const u=y.getCacheSearchData();u&&(l.value=u.data),N(),n()}),(u,e)=>{const U=q,D=G,s=Z,d=j,k=A,w=K,f=le,T=ae,R=ee,B=H,E=te,F=oe;return g(),C(F,{vertical:""},{default:t(()=>[a(B,{bordered:!1,class:"relative z-4 rd-12px"},{default:t(()=>[a(R,{"label-placement":"left","label-width":85,"require-mark-placement":"right-hanging",size:"small"},{default:t(()=>[a(f,{"item-style":"display: flex;",align:"center"},{default:t(()=>[a(s,{label:p(v)("page.library.searchKey")},{default:t(()=>[a(D,null,{default:t(()=>[a(U,{value:l.value.keyword,"onUpdate:value":e[0]||(e[0]=o=>l.value.keyword=o),type:"text",placeholder:"请输入标题关键词",class:"max-w-xl"},null,8,["value"])]),_:1})]),_:1},8,["label"]),a(s,null,{default:t(()=>[a(d,{value:l.value.tags,"onUpdate:value":[e[1]||(e[1]=o=>l.value.tags=o),n],options:S.value,placeholder:p(v)("page.library.tags"),multiple:"",filterable:"",clearable:"",class:"w-40"},null,8,["value","options","placeholder"])]),_:1}),a(s,null,{default:t(()=>[a(d,{value:l.value.years,"onUpdate:value":[e[2]||(e[2]=o=>l.value.years=o),n],placeholder:p(v)("page.library.yearGroup"),class:"w-40",clearable:"",multiple:"","max-tag-count":"responsive",options:[{label:"2025",value:"2025"},{label:"2024",value:"2024"},{label:"2023",value:"2023"},{label:"2022",value:"2022"},{label:"2021",value:"2021"},{label:"2020",value:"2020"},{label:"2019 - 2015",value:"2019-2015"},{label:"2014 - 2010",value:"2015-2010"},{label:"2009 - 2000",value:"2009-2000"},{label:"90年代",value:"1999-1990"},{label:"80年代",value:"1989-1980"},{label:"更早",value:"1979-1900"}]},null,8,["value","placeholder"])]),_:1}),a(s,null,{default:t(()=>[a(d,{value:l.value.sort,"onUpdate:value":[e[3]||(e[3]=o=>l.value.sort=o),n],options:h,class:"w-40"},null,8,["value"])]),_:1}),a(s,null,{default:t(()=>[a(d,{value:l.value.sortRule,"onUpdate:value":[e[4]||(e[4]=o=>l.value.sortRule=o),n],options:p(Q),class:"w-40"},null,8,["value","options"])]),_:1}),a(s,null,{default:t(()=>[a(k,{value:l.value.viewCount,"onUpdate:value":e[5]||(e[5]=o=>l.value.viewCount=o),"checked-value":0,"unchecked-value":-1,onUpdateValue:n},{checked:t(()=>e[9]||(e[9]=[r("未播放")])),unchecked:t(()=>e[10]||(e[10]=[r("全部")])),_:1},8,["value"])]),_:1}),a(s,null,{default:t(()=>[a(k,{value:l.value.favorite,"onUpdate:value":e[6]||(e[6]=o=>l.value.favorite=o),"checked-value":!0,"unchecked-value":void 0,onUpdateValue:n},{checked:t(()=>e[11]||(e[11]=[r("已收藏")])),unchecked:t(()=>e[12]||(e[12]=[r("全部")])),_:1},8,["value"])]),_:1}),a(s,null,{default:t(()=>[a(w,{type:"primary",onClick:n},{default:t(()=>[r(b(p(v)("common.search")),1)]),_:1})]),_:1}),a(s,null,{default:t(()=>[a(w,{type:"default",ghost:"",onClick:x},{default:t(()=>[r(b(p(v)("common.reset")),1)]),_:1})]),_:1})]),_:1}),a(T,{class:"ml-8"},{default:t(()=>[r(b("共找到 "+_.value+" 部影片"),1)]),_:1})]),_:1})]),_:1}),a(f,null,{default:t(()=>[(g(!0),I(M,null,L(m.value,o=>(g(),C(J,{key:o.id,class:"w-42 lg:w-48 xl:w-64",movie:o,sort:l.value.sort},null,8,["movie","sort"]))),128))]),_:1}),a(f,null,{default:t(()=>[a(E,{page:l.value.page,"onUpdate:page":e[7]||(e[7]=o=>l.value.page=o),"page-size":l.value.pageSize,"onUpdate:pageSize":e[8]||(e[8]=o=>l.value.pageSize=o),"page-count":c.value,"show-size-picker":"","page-sizes":p(W),onUpdatePage:n,onUpdatePageSize:n},null,8,["page","page-size","page-count","page-sizes"])]),_:1})]),_:1})}}});export{Se as default};
